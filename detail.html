<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>è©³ç´°ãƒ»è§£èª­ãƒ¢ãƒ¼ãƒ‰</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        #map { height: 100vh; width: 100%; background: #f0f0f0; }
        .controls { position: absolute; top: 10px; right: 10px; z-index: 1000; background: white; padding: 10px; border-radius: 5px; display: flex; flex-direction: column; gap: 5px; }
        .back-btn { position: absolute; top: 10px; left: 10px; z-index: 1000; background: #333; color: white; padding: 10px; text-decoration: none; border-radius: 5px; }
        .map-label { font-weight: bold; font-size: 24px; white-space: nowrap; }
    #info-panel {				
        position: absolute;				
        bottom: 20px;				
        right: 10px;				
        z-index: 1000;				
        background: white;				
        padding: 15px;				
        border-radius: 8px;				
        box-shadow: 0 0 10px rgba(0,0,0,0.2);				
        width: 250px;				
        display: none; /* æœ€åˆã¯éš ã—ã¦ãŠã */				

 </style>
</head>
<body>

<a href="index.html" class="back-btn">â† å…¨ä½“ã«æˆ»ã‚‹</a>

<div class="controls">
    <button onclick="changeMode(1)">1. å…ƒã®åœ°å›³ï¼ˆæ‹¡å¤§ç‰ˆï¼‰</button>
    <button onclick="changeMode(2)">2. è§£èª­åœ°å›³ï¼ˆæ‹¡å¤§ç‰ˆï¼‰</button>
    <button onclick="changeMode(3)">3. è§£æçµæœã¨èª¬æ˜ï¼ˆå­—ã®å‘ãçµ±ä¸€ï¼‰</button>
</div>
<div id="map"></div>

<div id="info-panel">							
    <div class="panel-title">ğŸ’¡ è§£èª­ã®è±†çŸ¥è­˜</div>							
    <p style="margin: 0; font-size: 14px;">							
        éƒ¨å±‹åãªã©ã«ã€Œå¾¡ï¼ˆãŠã‚“ãƒ»ã”ï¼‰ã€ãŒã¤ã„ã¦ã„ã‚‹ã“ã¨ãŒå¤šãã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯æ¥é ­è¾ï¼ˆä¸å¯§ã«ã™ã‚‹è¨€è‘‰ï¼‰ãŒã¤ã„ãŸã‚‚ã®ã§ã€å½“æ™‚ã®æ•¬æ„ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚							
    </p>							
</div>							

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    const map = L.map('map', { crs: L.CRS.Simple, minZoom: -1 });
    const bounds = [[0, 0], [1000, 1000]];

    // â‘  å…ƒã®åœ°å›³ã€æ‹¡å¤§ç‰ˆã€‘
    const layerOriginal = L.imageOverlay('igamonn.big.jpg', bounds);
    // â‘¡ è§£èª­åœ°å›³ã€æ‹¡å¤§ç‰ˆã€‘
    const layerKaidoku = L.imageOverlay('igamonn.ni.jpg', bounds);

    // æœ€åˆã¯ã€Œå…ƒã®åœ°å›³ã€ã‚’è¡¨ç¤º
    layerOriginal.addTo(map);
    map.fitBounds(bounds);
    //
    map.setMaxBounds(bounds);
    // â‘¢ èª¬æ˜ç”¨ã®æ–‡å­—ãƒ‡ãƒ¼ã‚¿
    const annotations = [
        { text: "å…«é–“ä¸€å°º", latlng: [372,332], rotation:0 , size:10,vertical:true,desc: "8é–“1å°º=ç´„1.818ï½" },
 ã€€ã€€ã€€ { text: "çŸ³å£é«˜å¼é–“", latlng: [448,220], rotation:0 , size:10,vertical:true,desc: "çŸ³å£ã®é«˜ã•ãŒ2é–“ï¼ˆ=ç´„3.636mï¼‰" },
        { text: "äºŒé–“", latlng: [312,275], rotation:0 , size:10,vertical:false,desc: "2é–“=ç´„3.636m" },
        { text: "å…­é–“", latlng: [331,275], rotation:0 , size:10,vertical:false,desc: "6é–“=ç´„10.908m" },
        { text: "æ«“äºŒé–“", latlng: [258,830], rotation:0 , size:10,vertical:true,desc: "2é–“=ç´„3.636mï¼ˆè¾°å·³æ«“ã®åºƒã•ã‚’è¡¨ã—ã¦ã„ã‚‹ã€‚ï¼‰" },
        { text: "è¾°è¦‹æ«“", latlng: [176,770], rotation:0 , size:15,vertical:true,desc: "è¾°å·³æ«“ã€€è¾°å·³ã¯æ–¹è§’ã®åå‰ã€‚è¾°ã¨å·³ã¨ã®é–“â†’å—æ±" },
        { text: "ä¸ƒå°ºäº”å¯¸å»»", latlng: [880,300], rotation:0 , size:8,vertical:false,desc: "7å°º5å¯¸ï¼ç´„267.1ãã€€æœ¨ã®å¤§ãã•ã‚’è¡¨ã—ã¦ã„ã‚‹ "},
        { text: "å…«å°ºäº”å¯¸å»»", latlng:[836,300], rotation:0 , size:8,vertical:false,desc: "8å°º5å¯¸ï¼ç´„257.6ãã€€æœ¨ã®å¤§ãã•ã‚’è¡¨ã—ã¦ã„ã‚‹ " },
        { text: "ä¸ƒå°ºå»»", latlng: [816,300], rotation:0 , size:8,vertical:false,desc: "7å°ºï¼ç´„212ãã€€æœ¨ã®å¤§ãã•ã‚’è¡¨ã—ã¦ã„ã‚‹ " },
        { text: "ä¹å°ºå»»", latlng: [780,300], rotation:0 , size:8,vertical:false,desc: "9å°ºï¼ç´„272.7ãã€€æœ¨ã®å¤§ãã•ã‚’è¡¨ã—ã¦ã„ã‚‹ " },
        { text: "äº”å°ºäº”å¯¸å»»", latlng: [755,300], rotation:0 , size:10,vertical:false,desc: "5å°º5å¯¸ï¼ç´„165ãã€€æœ¨ã®å¤§ãã•ã‚’è¡¨ã—ã¦ã„ã‚‹ " },
ã€€ã€€ã€€ã€€{ text: "ãƒ¢ãƒãƒæœ¨", latlng: [716,270], rotation:0 , size:10,vertical:false,desc: "ã€é»ã®æœ¨ã€‘ãƒ¢ãƒãƒã‚­ç§‘ã®å¸¸ç·‘é«˜æœ¨ã€‚è‘‰ã¯æ¥•å††å½¢ã€‚åˆå¤ã«è‘‰è…‹ã«é»„ç·‘è‰²ã®å°èŠ±ã‚’ã¤ã‘ã‚‹ã€‚ç§‹ã€çƒå½¢ã®æ¶²æœãŒèµ¤ãç†Ÿã™ã€‚æ¨¹çš®ã‹ã‚‰ã¯é³¥é»ã‚’ã¨ã‚‹ã€‚"},
        { text: "äºŒé–“", latlng: [203,757], rotation:0 , size:9,vertical:false,desc: "2é–“=ç´„3.636m" },
        { text: "ä¼Šè³€é–€", latlng: [117,286], rotation:0 , size:15,vertical:true,desc: "æ«“é–€ï¼ˆåŸé–€ã®ä¸Šã«å¹³æ«“ãŒè¼‰ã£ãŸå»ºç¯‰æ§˜å¼ï¼‰ã«ãªã£ã¦ã„ã‚‹ã€‚åŸé–€éƒ¨åˆ†ã®ä¸¡å´ãŒçŸ³å£ã«ãªã£ã¦ã„ã¦ã€åœŸå¡ä¸Šã®åœŸå¡€ã¨ã¤ãªãŒã£ã¦ã„ã‚‹ã€‚åœŸå¡€ã‹ã‚‰ã¯ã€é–€ã«æ¥ãŸæ•µã«å¯¾ã—ã¦æ¨ªçŸ¢ã‚’ã„ã‚‹ã“ã¨ãŒå‡ºæ¥ã‚‹æ§‹é€ ã¨ãªã£ã¦ã„ã‚‹ã€‚" },
        { text: "ä¸ƒé–“", latlng: [486,274], rotation:0 , size:10,vertical:false,desc: "7é–“=ç´„12.726m" },
        { text: "å¾¡ç¸å´", latlng: [784,58], rotation:0 , size:13,vertical:false,desc: "å®¶ã®åº§æ•·ã®å¤–å´ã«è¨­ã‘ãŸï¼Œç´°é•·ã„æ¿æ•·ãã®éƒ¨åˆ†ã€‚ãˆã‚“ã€‚"}, 
        { text: "å¾¡åºŠ", latlng: [900,24], rotation:0 , size:12,vertical:true,desc: "å¯ã‚‹ãŸã‚ã«è¨­ã‘ã‚‹ã¨ã“ã‚ã€‚ã­ã©ã“ã€‚"},
        { text: "å¾¡ä¸Šæ®µ", latlng: [863,88], rotation:0 , size:12,vertical:false,desc: "åºŠã‚’ä»–ã®éƒ¨å±‹ã‚ˆã‚Šä¸€æ®µé«˜ãã—ãŸéƒ¨å±‹ã€‚é«˜è²´ãªäººã®åº§æ‰€ã¨ã•ã‚ŒãŸã€‚" },
        { text: "å¾¡æ¬¡é–“", latlng: [865,170], rotation:0 , size:12,vertical:false,desc: "ã€å¾¡æ¬¡ã®é–“ã€‘ä¸»ãªåº§æ•·ã®éš£ã«ã¤ã„ã¦ã„ã‚‹å°éƒ¨å±‹ã€‚" },
        { text: "å¾¡å»Šä¸‹", latlng: [938,156], rotation:0 , size:13,vertical:false,desc: "å®¶ã®ä¸­ã®éƒ¨å±‹ã‚’ã¤ãªãç´°é•·ã„é€šè·¯ã€‚" },
        { text: "å¾¡ç´æˆ¸", latlng: [930,64], rotation:0 , size:13,vertical:false,desc: "ãªã‚“ã©ã€‚è¡£é¡ãƒ»å®¶è²¡ãƒ»é“å…·é¡ã‚’ã—ã¾ã£ã¦ãŠãéƒ¨å±‹ã€‚å±‹å†…ã®ç‰©ç½®éƒ¨å±‹ã€‚ä¸­ä¸–ä»¥é™ã€å¯å®¤ã«ã‚‚ç”¨ã„ã‚‰ã‚Œå¯é–“ï¼ˆã­ã¾ï¼‰ã¨ã‚‚å‘¼ã°ã‚Œã‚‹ã€‚" }//[ä¸‹â†’ä¸Š,å·¦â†’å³]

    ];

    const markers = L.layerGroup(); // æ–‡å­—ã‚’ã¾ã¨ã‚ã¦ç®¡ç†ã™ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—

    annotations.forEach(data => {
    // ç¸¦æ›¸ãã‹æ¨ªæ›¸ãã‹ã‚’åˆ¤å®šã™ã‚‹å‘½ä»¤									
    const writingMode = data.vertical ? 'vertical-rl' : 'horizontal-tb';									
    									
    const myIcon = L.divIcon({								
        className: 'map-label',									
        html: `<div style="									
            transform: rotate(${data.rotation}deg); 									
            font-size: ${data.size || 24}px; 									
            writing-mode: ${writingMode};									
            color: red;">${data.text}</div>`									
    });									
    									
    const marker = L.marker(data.latlng, { icon: myIcon });									
    marker.bindPopup(`<b>${data.text}</b><br>${data.desc}`);									
    markers.addLayer(marker);									
});									

    // åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
    function changeMode(mode) {
        // ä¸€æ—¦å…¨éƒ¨æ¶ˆã™
        map.removeLayer(layerOriginal);
        map.removeLayer(layerKaidoku);
        map.removeLayer(markers);

    // ä¸€æ—¦ãƒ‘ãƒãƒ«ã‚’éš ã™
    document.getElementById('info-panel').style.display = 'none';

    if (mode === 1) {
        layerOriginal.addTo(map);
    } else if (mode === 2) {
        layerKaidoku.addTo(map);
    } else if (mode === 3) {
        layerOriginal.addTo(map);
        markers.addTo(map);
		updateLabelSize();
        // ã€Œ3ã€ã®ã¨ãã ã‘ãƒ‘ãƒãƒ«ã‚’è¡¨ç¤ºã™ã‚‹
        document.getElementById('info-panel').style.display = 'block';
}

        if (mode === 1) {
            layerOriginal.addTo(map);
        } else if (mode === 2) {
            layerKaidoku.addTo(map);
        } else if (mode === 3) {
            layerOriginal.addTo(map); // èƒŒæ™¯ã¯å…ƒã®åœ°å›³
            markers.addTo(map);      // ãã®ä¸Šã«æ–‡å­—ã‚’è¡¨ç¤º
        }
    }

	// ã‚ºãƒ¼ãƒ ãƒ¬ãƒ™ãƒ«ã«åˆã‚ã›ã¦æ–‡å­—ã‚µã‚¤ã‚ºã‚’èª¿æ•´ã™ã‚‹é–¢æ•°
function updateLabelSize() {
    const currentZoom = map.getZoom();
    // åŸºæº–ã¨ãªã‚‹ã‚ºãƒ¼ãƒ ãƒ¬ãƒ™ãƒ«ï¼ˆä¾‹: 0ï¼‰ã®æ™‚ã®ã‚µã‚¤ã‚ºã‚’1å€ã¨ã—ã¾ã™
    // ã‚ºãƒ¼ãƒ ã™ã‚‹ã”ã¨ã«ã‚µã‚¤ã‚ºã‚’è¨ˆç®—ï¼ˆ1.5ã®(ã‚ºãƒ¼ãƒ å·®)ä¹—ãªã©ã§èª¿æ•´ï¼‰
    const scale = Math.pow(1.5, currentZoom); 

    const labels = document.querySelectorAll('.label-inner');
    labels.forEach((label, index) => {
        // annotationsãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å…ƒã®ã‚µã‚¤ã‚ºã‚’å–å¾—ï¼ˆãªã‘ã‚Œã°20pxã¨ã™ã‚‹ï¼‰
        const baseSize = annotations[index].size || 20;
        label.style.fontSize = (baseSize * scale) + 'px';
    });
}

// åœ°å›³ãŒã‚ºãƒ¼ãƒ ã•ã‚ŒãŸæ™‚ã«ã“ã®é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹è¨­å®š
map.on('zoomend', updateLabelSize);

// æœ€åˆã«è¡¨ç¤ºã—ãŸæ™‚ã«ã‚‚ä¸€åº¦å®Ÿè¡Œã—ã¦ã‚µã‚¤ã‚ºã‚’åˆã‚ã›ã‚‹
map.on('layeradd', function(e) {
    if (e.layer === markers) {
        updateLabelSize();
    }
});
// â‘  ã‚µã‚¤ã‚ºã‚’è¨ˆç®—ã—ã¦å¤‰ãˆã‚‹ã€Œé–¢æ•°ã€æœ¬ä½“
function updateLabelSize() {
    const currentZoom = map.getZoom();
    const scale = Math.pow(1.4, currentZoom); // 1.5ã ã¨å¤§ãã™ããŸå ´åˆã¯1.4ã«èª¿æ•´

    // ç”»é¢å†…ã®ã™ã¹ã¦ã®ãƒ©ãƒ™ãƒ«ã‚’ãƒ«ãƒ¼ãƒ—ã§å‡¦ç†
    document.querySelectorAll('.label-inner').forEach((label) => {
        // å…ƒã®ã‚µã‚¤ã‚ºï¼ˆ20pxï¼‰ã«å€ç‡ã‚’ã‹ã‘ã‚‹
        label.style.fontSize = (20 * scale) + "px";
    });
}

// â‘¡ ã€Œåœ°å›³ãŒã‚ºãƒ¼ãƒ ã•ã‚ŒãŸæ™‚ã€ã«â‘ ã‚’å®Ÿè¡Œã•ã›ã‚‹å‘½ä»¤
map.on('zoomend', updateLabelSize);

// â‘¢ ã€Œãƒ¢ãƒ¼ãƒ‰3ï¼ˆèª¬æ˜ä»˜ãï¼‰ã«åˆ‡ã‚Šæ›¿ã‚ã£ãŸç›´å¾Œã€ã«ã‚‚â‘ ã‚’å®Ÿè¡Œã•ã›ã‚‹ãŸã‚ã®å·¥å¤«
// changeModeé–¢æ•°ã® mode === 3 ã®ä¸­ã®ä¸€ç•ªæœ€å¾Œã«ã€ŒupdateLabelSize();ã€ã¨1è¡Œè¶³ã™ã¨å®Œç’§ã§ã™

	
</script>
</body>
</html>
